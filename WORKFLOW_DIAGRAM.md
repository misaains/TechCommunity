# 🔄 Схема взаимодействия Фронтенд ↔️ Бэкенд

## Общая картина

```
┌─────────────────────────────┐         HTTP/JSON         ┌─────────────────────────────┐
│                             │     ────────────────►      │                             │
│   ФРОНТЕНД (ВЫ)             │                            │   БЭКЕНД (Коллега)          │
│                             │     ◄────────────────      │                             │
│   PWA Application           │         Ответы             │   Kotlin REST API           │
│   HTML/CSS/JavaScript       │                            │   Spring Boot / Ktor        │
│                             │                            │                             │
│   localhost:8000            │                            │   localhost:8080            │
└─────────────────────────────┘                            └─────────────────────────────┘
```

## Как это работает

### 1️⃣ Пользователь открывает приложение

```
Браузер
  │
  ├─► Загружает index.html
  ├─► Загружает styles.css
  ├─► Загружает app.js
  └─► Загружает api.js ✨
```

### 2️⃣ Пользователь нажимает "Показать сообщества"

```javascript
// Фронтенд (ваш код в app.js):
async function loadCommunities() {
  const communities = await API.getCommunities();
  // communities = данные из бэкенда
  displayCommunities(communities);
}
```

### 3️⃣ Фронтенд отправляет запрос

```
Фронтенд (api.js)
  │
  └─► fetch('http://localhost:8080/api/communities')
       │
       └─► GET запрос →
```

### 4️⃣ Бэкенд обрабатывает запрос

```kotlin
// Бэкенд (код коллеги):
@GetMapping("/api/communities")
fun getCommunities(): List<Community> {
    // Достаёт данные из базы
    return database.getCommunities()
}
```

### 5️⃣ Бэкенд отправляет ответ

```json
← JSON ответ

[
  {
    "id": 1,
    "name": "Технологии и IT",
    "members": 12543
  },
  {
    "id": 2,
    "name": "Дизайнеры",
    "members": 8234
  }
]
```

### 6️⃣ Фронтенд получает данные и показывает пользователю

```javascript
// api.js автоматически парсит JSON
// app.js получает готовые данные

function displayCommunities(communities) {
  communities.forEach(community => {
    // Создаём карточку сообщества
    createCommunityCard(community);
  });
}
```

```
Браузер показывает:
┌──────────────────────────┐
│ 📱 Технологии и IT       │
│    12 543 участников     │
│    [Вступить]            │
└──────────────────────────┘
```

---

## Что ВЫ делаете (Фронтенд)

### ✅ Уже сделано:

1. **index.html** - структура приложения
2. **styles.css** - красивый дизайн
3. **app.js** - логика приложения
4. **api.js** - клиент для связи с бэкендом ✨
5. **API_SPECIFICATION.md** - документация для бэкенда

### 📝 Что осталось:

1. Отправить `API_SPECIFICATION.md` backend-разработчику
2. Получить от него адрес API
3. Вставить адрес в `api.js` (строка 5)
4. Проверить, что всё работает

---

## Что делает БЭКЕНД (Коллега)

### 📋 Его задачи:

1. **Создать REST API** на Kotlin (Spring Boot или Ktor)
2. **Реализовать endpoints** из `API_SPECIFICATION.md`:
   - `GET /api/communities` - вернуть сообщества
   - `GET /api/posts` - вернуть посты
   - `POST /api/posts` - создать пост
   - и т.д.
3. **Настроить CORS** (чтобы фронтенд мог делать запросы)
4. **Вернуть JSON** в нужном формате
5. **Сказать вам адрес API** (например, `http://localhost:8080/api`)

---

## Пример полного цикла

### Сценарий: Пользователь создаёт пост

```
1. Пользователь заполняет форму
   ↓
2. Нажимает кнопку "Опубликовать"
   ↓
3. Фронтенд (app.js):
   const data = {
     authorId: 1,
     content: "Привет!"
   };
   await API.createPost(data);
   ↓
4. api.js отправляет запрос:
   POST http://localhost:8080/api/posts
   Body: {"authorId": 1, "content": "Привет!"}
   ↓
5. Бэкенд (Kotlin):
   @PostMapping("/posts")
   fun createPost(data) {
     // Сохранить в базу
     return newPost
   }
   ↓
6. Бэкенд возвращает JSON:
   {"id": 123, "content": "Привет!", "likes": 0}
   ↓
7. Фронтенд получает ответ:
   console.log("Пост создан:", newPost)
   ↓
8. Показать уведомление пользователю:
   "✅ Пост опубликован!"
```

---

## Формат данных (важно!)

### Фронтенд ОЖИДАЕТ от бэкенда:

#### Сообщества:
```json
[
  {
    "id": 1,
    "name": "Технологии и IT",
    "description": "Разработчики будущего",
    "members": 12543,
    "category": "tech",
    "avatarUrl": "https://..."
  }
]
```

#### Посты:
```json
[
  {
    "id": 1,
    "authorName": "Алексей",
    "content": "Текст поста",
    "likes": 142,
    "comments": 28
  }
]
```

Если бэкенд вернёт данные в ДРУГОМ формате - фронтенд не заработает!

Поэтому важно договориться с backend-разработчиком о формате ЗАРАНЕЕ.

---

## Ваши действия (пошагово)

### Шаг 1: Отправить файлы backend-разработчику

Скопируйте и отправьте:
- `API_SPECIFICATION.md` ✅
- `MESSAGE_TO_BACKEND.txt` ✅

Можно через:
- Telegram / WhatsApp
- Email
- GitHub (создать Issue)
- Slack / Discord

---

### Шаг 2: Дождаться ответа

Backend-разработчик должен сказать:
```
"Привет! Я запустил бэкенд на http://localhost:8080/api
CORS настроен, можешь делать запросы."
```

---

### Шаг 3: Изменить api.js

Откройте файл `api.js`, найдите строку 5:
```javascript
API_BASE_URL: 'http://localhost:8080/api', // ← Вставьте адрес от бэкенда
```

Измените на адрес, который дал backend-разработчик.

---

### Шаг 4: Проверить

Откройте консоль браузера (F12):
```javascript
API.getCommunities().then(console.log)
```

Если видите данные - **всё работает!** 🎉

---

## Если работаете удалённо

### Backend на другом компьютере

1. Backend-разработчик должен использовать свой IP адрес:
```kotlin
embeddedServer(Netty, port = 8080, host = "0.0.0.0") // ← 0.0.0.0 = все интерфейсы
```

2. Узнать свой IP (Windows):
```powershell
ipconfig
# Найти: IPv4 Address: 192.168.1.100
```

3. Дать вам адрес:
```
http://192.168.1.100:8080/api
```

4. Вы вставляете этот адрес в `api.js`

---

## Советы

### 💡 Совет 1: Договоритесь о формате данных
Покажите backend-разработчику примеры из `API_SPECIFICATION.md`

### 💡 Совет 2: Тестируйте каждый endpoint отдельно
Не ждите, пока будет готово всё. Проверяйте по одному endpoint.

### 💡 Совет 3: Используйте mock-данные
Пока бэкенд не готов, можете использовать временные данные:
```javascript
// Временно, пока бэкенд не готов
const mockCommunities = [
  {id: 1, name: "Тест", members: 100}
];
```

---

## Чеклист совместной работы

### Фронтенд (вы):
- [x] Создал `api.js`
- [x] Создал `API_SPECIFICATION.md`
- [ ] Отправил спецификацию бэкенду
- [ ] Получил адрес API
- [ ] Изменил `api.js`
- [ ] Протестировал

### Бэкенд (коллега):
- [ ] Получил спецификацию
- [ ] Настроил CORS
- [ ] Реализовал endpoints
- [ ] Запустил сервер
- [ ] Дал адрес API фронтенду
- [ ] Протестировал через Postman

---

**Удачи! Теперь вы знаете, как всё работает!** 🚀
